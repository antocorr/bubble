var m;function h(t){let n=t,o=[];function c(){o.forEach(r=>r())}function p(r){n=r,c()}function l(){return m&&o.push(m),n}return[l,p,c]}function s(t){m=t,t(),m=null}var u=class t{get;set;refresh;constructor(n){let[o,c,p]=h(n);this.get=o,this.set=c,this.refresh=p}get value(){return this.get()}set value(n){this.set(n)}push(n){this.value.push(new t(n)),this.refresh()}};function f(t){return new u(t)}function v(t){let n=document.createElement("template");return n.innerHTML=t.trim(),n.content.firstElementChild}var x=[];function _(t){return t=t.replace(/@click/g,"-x-onclick"),t}function y(t){let n=t.split("{{"),o=[];for(let c=0;c<n.length;c++)if(n[c].includes("}}")){let p=n[c].split("}}");n[c]=p[0],n.splice(c+1,0,p[1]),o.push(c)}return[n,o]}function g(t,n,o,c,p={}){let l="",r={...t._data,...p};Object.keys(p).length;for(let i=0;i<o.length;i++)if(c.includes(i)){let a=o[i];r&&r[a]?l+=r[a].value:console.error(`Key ${a} not found in data`)}else l+=o[i];n.textContent=l}function A(original,data){let props={};data&&data.props&&(props=data.props,typeof props=="function"&&(props=props()),delete data.props);let component={$element:null,appendTo:t=>{component.$element&&(t.appendChild(component.$element),component.mounted&&component.mounted())},refs:{},...original,...data},tp=component.setTemplate?component.setTemplate:component.template;if(typeof tp=="function"&&(tp=tp()),tp&&(component.$element=v(_(tp))),component.$element){if([...component.$element.querySelectorAll("[ref]")].forEach(t=>{component.refs[t.getAttribute("ref")]=t}),[...component.$element.querySelectorAll("[-x-onclick]")].forEach(e=>{let _this_component=component,fn=e.getAttribute("-x-onclick").replace("this.","_this_component.");e.onclick=()=>eval(fn)}),component.data){typeof component.data=="function"&&(component.data=component.data()),component._data={};let t={...component.data,...props};for(let n in t)if(component._data[n]=f(t[n]),Array.isArray(t[n]))for(let o=0;o<t[n].length;o++)component._data[n].value[o]=f(t[n][o])}[...component.$element.querySelectorAll("[x-model]")].forEach(t=>{let n=t.getAttribute("x-model");component._data&&component._data[n]&&(t.value=component._data[n].value,t.oninput=()=>{component._data[n].value=t.value},s(()=>{t.value=component._data[n].value}))});let textNodes=component.$element.querySelectorAll("*:not([x-for])");for(let t of textNodes)for(let n of t.childNodes)if(n.nodeType===3&&n.textContent.includes("{{")){let[o,c]=y(n.textContent);s(()=>{g(component,n,o,c)})}[...component.$element.querySelectorAll("[x-for]")].forEach(t=>{let n=t.getAttribute("x-for").split(" in "),o=n[1],c=n[0],[p,l]=y(t.textContent),r=t.parentElement;s(()=>{for(;r.firstChild;)r.removeChild(r.firstChild);if(component._data&&component._data[o]){let i=component._data[o].value;for(let a of i){let d=t.cloneNode(!0);d.removeAttribute("x-for"),g(component,d,p,l,{[c]:a}),r.appendChild(d)}}})})}if(component.style&&!x.includes(component.compId)){let t=component.style;typeof t=="function"&&(t=t());let n=document.createElement("style");n.innerHTML=t,document.head.appendChild(n),component.compId&&x.push(component.compId)}return component.init&&component.init(),component}export{f as Signal,A as createComponent,h as createSignal,s as effect,v as html};
//# sourceMappingURL=bubble.js.map
